---
layout: page
title: Categories
permalink: /categories/
---

<link rel="stylesheet" href="{{ '/assets/css/categories.css' | relative_url }}">

<div class="kakao-categories-page">
  {% assign category_list = "Backend,Frontend,Infra,CS" | split: "," %}

  <div class="categories-container">
    {% for cat in category_list %}
    {% assign cat_lower = cat | downcase %}
    {% assign post_count = 0 %}
    {% for post in site.posts %}
    {% assign post_cat = post.categories | first | downcase %}
    {% if post_cat == cat_lower %}
    {% assign post_count = post_count | plus: 1 %}
    {% endif %}
    {% endfor %}

    <div class="category-section">
      <div class="cat-header {{ cat_lower }} js-toggle-category" data-category="{{ cat_lower }}">
          <span class="cat-emoji">
            {% case cat %}
              {% when 'Backend' %} ğŸ’»
              {% when 'Frontend' %} ğŸ¨
              {% when 'Infra' %} âš™ï¸
              {% when 'CS' %} ğŸ§ 
            {% endcase %}
          </span>
        <div class="cat-info">
          <div class="cat-name">{{ cat }}</div>
          <div class="cat-count">{{ post_count }}ê°œ í¬ìŠ¤íŠ¸</div>
        </div>
      </div>

      <div class="dropdown-content" id="dropdown-{{ cat_lower }}">
        <div class="posts-grid" id="posts-{{ cat_lower }}"></div>
        <div class="pagination-container" id="pagination-{{ cat_lower }}"></div>
      </div>
    </div>
    {% endfor %}
  </div>
</div>

<script>
  window.sitePosts = {{ site.posts | jsonify | escape }};

  const POSTS_PER_PAGE = 5;
  const pages = {};

  document.querySelectorAll('.js-toggle-category').forEach(header => {
    header.addEventListener('click', () => {
      const cat = header.dataset.category;
      const dropdown = document.getElementById(`dropdown-${cat}`);
      const isOpen = dropdown.classList.contains('open');

      // ëª¨ë“  ë“œë¡­ë‹¤ìš´ ë‹«ê¸°
      document.querySelectorAll('.dropdown-content').forEach(d => d.classList.remove('open'));

      // í† ê¸€
      if (!isOpen) {
        dropdown.classList.add('open');
        pages[cat] = pages[cat] || 1;
        loadPostsForCategory(cat, pages[cat]);
      }
    });
  });

  function loadPostsForCategory(cat, page = 1) {
    const categoryPosts = window.sitePosts
      .filter(post => {
        const postCats = post.categories || [];
        return postCats.some(postCat => postCat.toString().toLowerCase() === cat);
      })
      .sort((a, b) => new Date(b.date) - new Date(a.date));

    const container = document.getElementById(`posts-${cat}`);
    const pagination = document.getElementById(`pagination-${cat}`);

    if (categoryPosts.length === 0) {
      container.innerHTML = `
        <div class="empty-state">
          <div class="empty-icon">ğŸ“</div>
          <h3>ì•„ì§ ì‘ì„±ëœ ê¸€ì´ ì—†ìŠµë‹ˆë‹¤</h3>
          <p>ì´ ì¹´í…Œê³ ë¦¬ì— ì†í•œ ê¸€ì´ ì—†ì–´ìš”.</p>
        </div>
      `;
      pagination.innerHTML = '';
    } else {
      const start = (page - 1) * POSTS_PER_PAGE;
      const paginatedPosts = categoryPosts.slice(start, start + POSTS_PER_PAGE).map(post => ({
        title: post.title || 'ì œëª© ì—†ìŒ',
        excerpt: (post.excerpt || '').replace(/<[^>]*>/g, '').substring(0, 100) + '...',
        date: new Date(post.date).toLocaleDateString('ko-KR', {year:'numeric', month:'2-digit', day:'2-digit'}),
        url: post.url
      }));

      container.innerHTML = paginatedPosts.map(post => `
        <a href="${post.url}" class="post-card">
          <h3 class="post-title">${post.title}</h3>
          <p class="post-excerpt">${post.excerpt}</p>
          <span class="post-date">${post.date}</span>
        </a>
      `).join('');

      const totalPages = Math.ceil(categoryPosts.length / POSTS_PER_PAGE);
      pages[cat] = page;

      pagination.innerHTML = `
        <button class="page-btn" ${page === 1 ? 'disabled' : ''} onclick="loadPostsForCategory('${cat}', ${page-1})">â† ì´ì „</button>
        <span class="page-info">${page} / ${totalPages}</span>
        <button class="page-btn" ${page === totalPages ? 'disabled' : ''} onclick="loadPostsForCategory('${cat}', ${page+1})">ë‹¤ìŒ â†’</button>
      `;
    }
  }
</script>
